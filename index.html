<!-- Inside your existing <script> tag -->
    <script>
        function handleCredentialResponse(response) {
            const id_token = response.credential;
            console.log(id_token);
    
            fetch('http://localhost:3001/verify-token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ token: id_token }),
            })
            .then((res) => res.json())
            .then((data) => {
                console.log('User data:', data);
                console.log('Server message:', data.message); // Log the message to debug
    
                // Loosened the check: if server says success, redirect
                if (data.message && (data.message.includes('User found') || data.message.includes('User created'))) {
                    window.location.href = 'budget-table.html';
                } else {
                    console.error('Login failed or unexpected message:', data.message);
                }
            })
            .catch((error) => {
                console.error('Error during token verification:', error);
            });
        }
    
        window.onload = function () {
            google.accounts.id.initialize({
                client_id: '457823584077-c1td3bd3i5c6itoki7kcclc04id31bhp.apps.googleusercontent.com',
                callback: handleCredentialResponse,
            });
    
            google.accounts.id.renderButton(
                document.getElementById('g_signin2'),
                { theme: 'outline', size: 'large' }
            );
    
            google.accounts.id.prompt();
        };
    </script>
    